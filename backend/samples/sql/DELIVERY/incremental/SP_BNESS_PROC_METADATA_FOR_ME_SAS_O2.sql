CREATE OR REPLACE PROCEDURE SP_BUSINESS_PROCESS_METADATA_FOR_ME_SAS_O2 () RETURNS INTEGER
   LANGUAGE nzplsql AS BEGIN_PROC

DECLARE VAR_BUSINESS_PROCESS_ID_01 INT ;
VAR_BUSINESS_PROCESS_ID_02 INT ;
VAR_BUSINESS_PROCESS_STEP_ID_01 INT ;
VAR_BUSINESS_PROCESS_STEP_ID_02 INT ;
VAR_BUSINESS_PROCESS_STEP_ID_03 INT ;
VAR_BUSINESS_PROCESS_STEP_ID_04 INT ;
VAR_BUSINESS_PROCESS_STEP_ID_05 INT ;
VAR_BUSINESS_PROCESS_STEP_ID_06 INT ;
VAR_BUSINESS_PROCESS_STEP_ID_07 INT ;
VAR_BUSINESS_PROCESS_STEP_ID_08 INT ;

VAR_BUSINESS_EVENT_ID_01 INT ;
VAR_BUSINESS_EVENT_ID_02 INT ;
VAR_BUSINESS_EVENT_ID_03 INT ;
VAR_BUSINESS_EVENT_ID_04 INT ;
VAR_BUSINESS_EVENT_ID_05 INT ;
VAR_BUSINESS_EVENT_ID_06 INT ;
VAR_BUSINESS_EVENT_ID_07 INT ;
VAR_BUSINESS_EVENT_ID_08 INT ;
VAR_BUSINESS_EVENT_ID_09 INT ;
VAR_BUSINESS_EVENT_ID_10 INT ;
VAR_BUSINESS_EVENT_ID_11 INT ;
VAR_BUSINESS_EVENT_ID_12 INT ;
VAR_BUSINESS_EVENT_ID_13 INT ;
VAR_BUSINESS_EVENT_ID_14 INT ;
VAR_BUSINESS_EVENT_ID_15 INT ;
VAR_BUSINESS_EVENT_PARAM_VALUATION_ID_01 INT ;
VAR_ORCHESTRATION_PROCESS_ID_01 INT ;
VAR_ORCHESTRATION_PROCESS_ID_02 INT ;
VAR_ORCHESTRATION_PROCESS_ID_03 INT ;
VAR_ORCHESTRATION_PROCESS_ID_04 INT ;
VAR_ORCHESTRATION_PROCESS_ID_05 INT ;
VAR_ORCHESTRATION_PROCESS_ID_06 INT ;
L_ERR_CD				CHAR(5);
L_ERR_MSG				VARCHAR(32000);


BEGIN
SET ISOLATION TO UR;

SET VAR_BUSINESS_PROCESS_ID_01 = NEXT VALUE FOR SEQUENCE_BUSINESS_CALENDAR_METADATA;
SET VAR_BUSINESS_PROCESS_ID_02 = NEXT VALUE FOR SEQUENCE_BUSINESS_CALENDAR_METADATA;
SET VAR_BUSINESS_PROCESS_STEP_ID_01 = NEXT VALUE FOR SEQUENCE_BUSINESS_CALENDAR_METADATA;
SET VAR_BUSINESS_PROCESS_STEP_ID_02 = NEXT VALUE FOR SEQUENCE_BUSINESS_CALENDAR_METADATA;
SET VAR_BUSINESS_PROCESS_STEP_ID_03 = NEXT VALUE FOR SEQUENCE_BUSINESS_CALENDAR_METADATA;
SET VAR_BUSINESS_PROCESS_STEP_ID_04 = NEXT VALUE FOR SEQUENCE_BUSINESS_CALENDAR_METADATA;
SET VAR_BUSINESS_PROCESS_STEP_ID_05 = NEXT VALUE FOR SEQUENCE_BUSINESS_CALENDAR_METADATA;
SET VAR_BUSINESS_PROCESS_STEP_ID_06 = NEXT VALUE FOR SEQUENCE_BUSINESS_CALENDAR_METADATA;
SET VAR_BUSINESS_PROCESS_STEP_ID_07 = NEXT VALUE FOR SEQUENCE_BUSINESS_CALENDAR_METADATA;
SET VAR_BUSINESS_PROCESS_STEP_ID_08 = NEXT VALUE FOR SEQUENCE_BUSINESS_CALENDAR_METADATA;
SET VAR_BUSINESS_EVENT_ID_01 = NEXT VALUE FOR SEQUENCE_BUSINESS_CALENDAR_METADATA;
SET VAR_BUSINESS_EVENT_ID_02 = NEXT VALUE FOR SEQUENCE_BUSINESS_CALENDAR_METADATA;
SET VAR_BUSINESS_EVENT_ID_03 = NEXT VALUE FOR SEQUENCE_BUSINESS_CALENDAR_METADATA;
SET VAR_BUSINESS_EVENT_ID_04 = NEXT VALUE FOR SEQUENCE_BUSINESS_CALENDAR_METADATA;
SET VAR_BUSINESS_EVENT_ID_05 = NEXT VALUE FOR SEQUENCE_BUSINESS_CALENDAR_METADATA;
SET VAR_BUSINESS_EVENT_ID_06 = NEXT VALUE FOR SEQUENCE_BUSINESS_CALENDAR_METADATA;
SET VAR_BUSINESS_EVENT_ID_07 = NEXT VALUE FOR SEQUENCE_BUSINESS_CALENDAR_METADATA;
SET VAR_BUSINESS_EVENT_ID_08 = NEXT VALUE FOR SEQUENCE_BUSINESS_CALENDAR_METADATA;
SET VAR_BUSINESS_EVENT_ID_09 = NEXT VALUE FOR SEQUENCE_BUSINESS_CALENDAR_METADATA;
SET VAR_BUSINESS_EVENT_ID_10 = NEXT VALUE FOR SEQUENCE_BUSINESS_CALENDAR_METADATA;
SET VAR_BUSINESS_EVENT_ID_11 = NEXT VALUE FOR SEQUENCE_BUSINESS_CALENDAR_METADATA;
SET VAR_BUSINESS_EVENT_ID_12 = NEXT VALUE FOR SEQUENCE_BUSINESS_CALENDAR_METADATA;
SET VAR_BUSINESS_EVENT_ID_13 = NEXT VALUE FOR SEQUENCE_BUSINESS_CALENDAR_METADATA;
SET VAR_BUSINESS_EVENT_ID_14 = NEXT VALUE FOR SEQUENCE_BUSINESS_CALENDAR_METADATA;
SET VAR_BUSINESS_EVENT_ID_15 = NEXT VALUE FOR SEQUENCE_BUSINESS_CALENDAR_METADATA;
SET VAR_BUSINESS_EVENT_PARAM_VALUATION_ID_01 = NEXT VALUE FOR SEQUENCE_BUSINESS_CALENDAR_METADATA;

INSERT INTO BUSINESS_PROCESS (BUSINESS_PROCESS_ID, BUSINESS_PROCESS_NAME, CLOSING_TYPE_CODE, SCENARIO_TYPE, RUN_TYPE)
	VALUES(VAR_BUSINESS_PROCESS_ID_01, 'Business Process for Modelling Engine to DIP (RDWH) Data Flow', 'I17G', 'CLOSING', 'POSTING');

INSERT INTO BUSINESS_PROCESS (BUSINESS_PROCESS_ID, BUSINESS_PROCESS_NAME, CLOSING_TYPE_CODE, SCENARIO_TYPE, RUN_TYPE)
	VALUES(VAR_BUSINESS_PROCESS_ID_02, 'Business Process for DIP to SAS to DIP and to Omega Data Flow', 'I17G', 'CLOSING', 'POSTING');

INSERT INTO BUSINESS_PROCESS_STEP (BUSINESS_PROCESS_STEP_ID, BUSINESS_PROCESS_STEP_NAME, BUSINESS_PROCESS_ID, STEP_SEQUENCE)
	VALUES(VAR_BUSINESS_PROCESS_STEP_ID_01, 'APAC Modeling Engine to RDWH (DIP) Data Flow', VAR_BUSINESS_PROCESS_ID_01, 1);

INSERT INTO BUSINESS_PROCESS_STEP (BUSINESS_PROCESS_STEP_ID, BUSINESS_PROCESS_STEP_NAME, BUSINESS_PROCESS_ID, STEP_SEQUENCE)
	VALUES(VAR_BUSINESS_PROCESS_STEP_ID_02, 'Canada Modeling Engine to RDWH (DIP) Data Flow', VAR_BUSINESS_PROCESS_ID_01, 1);

INSERT INTO BUSINESS_PROCESS_STEP (BUSINESS_PROCESS_STEP_ID, BUSINESS_PROCESS_STEP_NAME, BUSINESS_PROCESS_ID, STEP_SEQUENCE)
	VALUES(VAR_BUSINESS_PROCESS_STEP_ID_03, 'FR-GE Modeling Engine to RDWH (DIP) Data Flow', VAR_BUSINESS_PROCESS_ID_01, 1);

INSERT INTO BUSINESS_PROCESS_STEP (BUSINESS_PROCESS_STEP_ID, BUSINESS_PROCESS_STEP_NAME, BUSINESS_PROCESS_ID, STEP_SEQUENCE)
	VALUES(VAR_BUSINESS_PROCESS_STEP_ID_04, 'UK Modeling Engine to RDWH (DIP) Data Flow', VAR_BUSINESS_PROCESS_ID_01, 1);

INSERT INTO BUSINESS_PROCESS_STEP (BUSINESS_PROCESS_STEP_ID, BUSINESS_PROCESS_STEP_NAME, BUSINESS_PROCESS_ID, STEP_SEQUENCE)
	VALUES(VAR_BUSINESS_PROCESS_STEP_ID_05, 'US Modeling Engine to RDWH (DIP) Data Flow', VAR_BUSINESS_PROCESS_ID_01, 1);

INSERT INTO BUSINESS_PROCESS_STEP (BUSINESS_PROCESS_STEP_ID, BUSINESS_PROCESS_STEP_NAME, BUSINESS_PROCESS_ID, STEP_SEQUENCE)
	VALUES(VAR_BUSINESS_PROCESS_STEP_ID_06, 'RDWH MU Upload Data Flow', VAR_BUSINESS_PROCESS_ID_01, 1);

INSERT INTO BUSINESS_PROCESS_STEP (BUSINESS_PROCESS_STEP_ID, BUSINESS_PROCESS_STEP_NAME, BUSINESS_PROCESS_ID, STEP_SEQUENCE)
	VALUES(VAR_BUSINESS_PROCESS_STEP_ID_07, 'DIP > SAS > DIP Data Flow', VAR_BUSINESS_PROCESS_ID_02, 1);

INSERT INTO BUSINESS_PROCESS_STEP (BUSINESS_PROCESS_STEP_ID, BUSINESS_PROCESS_STEP_NAME, BUSINESS_PROCESS_ID, STEP_SEQUENCE)
	VALUES(VAR_BUSINESS_PROCESS_STEP_ID_08, 'DIP to Omega (SAS Results) Data Flow', VAR_BUSINESS_PROCESS_ID_02, 2);


INSERT INTO BUSINESS_EVENT (BUSINESS_EVENT_ID, EVENT_CODE, CLOSING_TYPE_CODE, SCENARIO_TYPE, RUN_TYPE, IS_ACTIVE, TRIGGER_MODE, DELAY_DAYS)
	VALUES(VAR_BUSINESS_EVENT_ID_01, 'EVT_INGEST_APAC_CASHFLOWS_FOR_VALIDATION', 'I17G', 'CLOSING', 'POSTING', true, 'External System Triggered', NULL);

INSERT INTO BUSINESS_EVENT (BUSINESS_EVENT_ID, EVENT_CODE, CLOSING_TYPE_CODE, SCENARIO_TYPE, RUN_TYPE, IS_ACTIVE, TRIGGER_MODE, DELAY_DAYS)
	VALUES(VAR_BUSINESS_EVENT_ID_02, 'EVT_APAC_CASHFLOWS_VALIDATED', 'I17G', 'CLOSING', 'POSTING', true, 'External System Triggered', NULL);

INSERT INTO BUSINESS_EVENT (BUSINESS_EVENT_ID, EVENT_CODE, CLOSING_TYPE_CODE, SCENARIO_TYPE, RUN_TYPE, IS_ACTIVE, TRIGGER_MODE, DELAY_DAYS)
	VALUES(VAR_BUSINESS_EVENT_ID_03, 'EVT_INGEST_CANADA_CASHFLOWS_FOR_VALIDATION', 'I17G', 'CLOSING', 'POSTING', true, 'External System Triggered', NULL);

INSERT INTO BUSINESS_EVENT (BUSINESS_EVENT_ID, EVENT_CODE, CLOSING_TYPE_CODE, SCENARIO_TYPE, RUN_TYPE, IS_ACTIVE, TRIGGER_MODE, DELAY_DAYS)
	VALUES(VAR_BUSINESS_EVENT_ID_04, 'EVT_CANADA_CASHFLOWS_VALIDATED', 'I17G', 'CLOSING', 'POSTING', true, 'External System Triggered', NULL);

INSERT INTO BUSINESS_EVENT (BUSINESS_EVENT_ID, EVENT_CODE, CLOSING_TYPE_CODE, SCENARIO_TYPE, RUN_TYPE, IS_ACTIVE, TRIGGER_MODE, DELAY_DAYS)
	VALUES(VAR_BUSINESS_EVENT_ID_05, 'EVT_INGEST_FRGE_CASHFLOWS_FOR_VALIDATION', 'I17G', 'CLOSING', 'POSTING', true, 'External System Triggered', NULL);

INSERT INTO BUSINESS_EVENT (BUSINESS_EVENT_ID, EVENT_CODE, CLOSING_TYPE_CODE, SCENARIO_TYPE, RUN_TYPE, IS_ACTIVE, TRIGGER_MODE, DELAY_DAYS)
	VALUES(VAR_BUSINESS_EVENT_ID_06, 'EVT_FRGE_CASHFLOWS_VALIDATED', 'I17G', 'CLOSING', 'POSTING', true, 'External System Triggered', NULL);

INSERT INTO BUSINESS_EVENT (BUSINESS_EVENT_ID, EVENT_CODE, CLOSING_TYPE_CODE, SCENARIO_TYPE, RUN_TYPE, IS_ACTIVE, TRIGGER_MODE, DELAY_DAYS)
	VALUES(VAR_BUSINESS_EVENT_ID_07, 'EVT_INGEST_UK_CASHFLOWS_FOR_VALIDATION', 'I17G', 'CLOSING', 'POSTING', true, 'External System Triggered', NULL);

INSERT INTO BUSINESS_EVENT (BUSINESS_EVENT_ID, EVENT_CODE, CLOSING_TYPE_CODE, SCENARIO_TYPE, RUN_TYPE, IS_ACTIVE, TRIGGER_MODE, DELAY_DAYS)
	VALUES(VAR_BUSINESS_EVENT_ID_08, 'EVT_UK_CASHFLOWS_VALIDATED', 'I17G', 'CLOSING', 'POSTING', true, 'External System Triggered', NULL);

INSERT INTO BUSINESS_EVENT (BUSINESS_EVENT_ID, EVENT_CODE, CLOSING_TYPE_CODE, SCENARIO_TYPE, RUN_TYPE, IS_ACTIVE, TRIGGER_MODE, DELAY_DAYS)
	VALUES(VAR_BUSINESS_EVENT_ID_09, 'EVT_INGEST_US_CASHFLOWS_FOR_VALIDATION', 'I17G', 'CLOSING', 'POSTING', true, 'External System Triggered', NULL);

INSERT INTO BUSINESS_EVENT (BUSINESS_EVENT_ID, EVENT_CODE, CLOSING_TYPE_CODE, SCENARIO_TYPE, RUN_TYPE, IS_ACTIVE, TRIGGER_MODE, DELAY_DAYS)
	VALUES(VAR_BUSINESS_EVENT_ID_10, 'EVT_US_CASHFLOWS_VALIDATED', 'I17G', 'CLOSING', 'POSTING', true, 'External System Triggered', NULL);

INSERT INTO BUSINESS_EVENT (BUSINESS_EVENT_ID, EVENT_CODE, CLOSING_TYPE_CODE, SCENARIO_TYPE, RUN_TYPE, IS_ACTIVE, TRIGGER_MODE, DELAY_DAYS)
	VALUES(VAR_BUSINESS_EVENT_ID_11, 'EVT_INGEST_MU_CASHFLOWS_FOR_VALIDATION', 'I17G', 'CLOSING', 'POSTING', true, 'DIP Triggered', NULL);

INSERT INTO BUSINESS_EVENT (BUSINESS_EVENT_ID, EVENT_CODE, CLOSING_TYPE_CODE, SCENARIO_TYPE, RUN_TYPE, IS_ACTIVE, TRIGGER_MODE, DELAY_DAYS)
	VALUES(VAR_BUSINESS_EVENT_ID_12, 'EVT_MU_CASHFLOWS_VALIDATED', 'I17G', 'CLOSING', 'POSTING', true, 'DIP Triggered', NULL);

INSERT INTO BUSINESS_EVENT (BUSINESS_EVENT_ID, EVENT_CODE, CLOSING_TYPE_CODE, SCENARIO_TYPE, RUN_TYPE, IS_ACTIVE, TRIGGER_MODE, DELAY_DAYS)
	VALUES(VAR_BUSINESS_EVENT_ID_13, 'EVT_DIP_TO_SAS_DATA', 'I17G', 'CLOSING', 'POSTING', true, 'DIP Triggered', NULL);


SELECT ORCHESTRATION_PROCESS_ID INTO VAR_ORCHESTRATION_PROCESS_ID_01 FROM ORCHESTRATION_PROCESS WHERE ORCHESTRATION_PROCESS_NAME = 'APAC Modeling Engine to DIP';
SELECT ORCHESTRATION_PROCESS_ID INTO VAR_ORCHESTRATION_PROCESS_ID_02 FROM ORCHESTRATION_PROCESS WHERE ORCHESTRATION_PROCESS_NAME = 'CANADA Modeling Engine to DIP';
SELECT ORCHESTRATION_PROCESS_ID INTO VAR_ORCHESTRATION_PROCESS_ID_03 FROM ORCHESTRATION_PROCESS WHERE ORCHESTRATION_PROCESS_NAME = 'FR-GE Modeling Engine to DIP';
SELECT ORCHESTRATION_PROCESS_ID INTO VAR_ORCHESTRATION_PROCESS_ID_04 FROM ORCHESTRATION_PROCESS WHERE ORCHESTRATION_PROCESS_NAME = 'UK Modeling Engine to DIP';
SELECT ORCHESTRATION_PROCESS_ID INTO VAR_ORCHESTRATION_PROCESS_ID_05 FROM ORCHESTRATION_PROCESS WHERE ORCHESTRATION_PROCESS_NAME = 'US Modeling Engine to DIP';
SELECT ORCHESTRATION_PROCESS_ID INTO VAR_ORCHESTRATION_PROCESS_ID_06 FROM ORCHESTRATION_PROCESS WHERE ORCHESTRATION_PROCESS_NAME = 'RDWH MU Upload';


INSERT INTO BUSINESS_EVENT_PARAM_VALUATION 
(BUSINESS_EVENT_PARAM_VALUATION_ID, BUSINESS_EVENT_ID, DATA_SET, PARAMETER_NAMES, PARENT_ORCHESTRATION_PROCESS_IDS, PARENT_BATCH_IDS, PARENT_CLOSING_TYPE_CODE
, PARENT_SCENARIO_TYPE, PARENT_RUN_TYPE, PARENT_CLOSING_PERIOD, DEFAULTING_RULE, VALUATION_PROCESSING, SPECIFIC_PROCESS)
	VALUES(VAR_BUSINESS_EVENT_PARAM_VALUATION_ID_01, VAR_BUSINESS_EVENT_ID_13
	, 'CF', 'CF_CLOSING_TYPE=' || chr(36) || '{CLOSING_TYPE};CF_CLOSING_DATE=' || chr(36) || '{CLOSING_DATE};CF_SCENARIO_TYPE=' || chr(36) || '{SCENARIO_TYPE};CF_RUN_TYPE=' || chr(36) || '{RUN_TYPE};CF_CLOSING_PERIOD=' || chr(36) || '{CLOSING_PERIOD};'
	, '' || VAR_ORCHESTRATION_PROCESS_ID_01 || ', ' || VAR_ORCHESTRATION_PROCESS_ID_02 || ', ' || VAR_ORCHESTRATION_PROCESS_ID_03 || ', ' || VAR_ORCHESTRATION_PROCESS_ID_04 || ', ' || VAR_ORCHESTRATION_PROCESS_ID_05 || ', ' || VAR_ORCHESTRATION_PROCESS_ID_06 || ''
	, NULL, 'I17G', 'CLOSING', 'POSTING', 'EVENT_CONTEXT'
	, 'IDS=ANY,CLOSING_TYPE=I17G,SCENARIO_TYPE=CLOSING,RUN_TYPE=ANY,CLOSING_PERIOD=ANY', NULL, NULL);


INSERT INTO BUSINESS_EVENT (BUSINESS_EVENT_ID, EVENT_CODE, CLOSING_TYPE_CODE, SCENARIO_TYPE, RUN_TYPE, IS_ACTIVE, TRIGGER_MODE, DELAY_DAYS)
	VALUES(VAR_BUSINESS_EVENT_ID_14, 'EVT_SAS_TO_DIP_RESULTS', 'I17G', 'CLOSING', 'POSTING', true, 'External System Triggered', NULL);

INSERT INTO BUSINESS_EVENT (BUSINESS_EVENT_ID, EVENT_CODE, CLOSING_TYPE_CODE, SCENARIO_TYPE, RUN_TYPE, IS_ACTIVE, TRIGGER_MODE, DELAY_DAYS)
	VALUES(VAR_BUSINESS_EVENT_ID_15, 'EVT_DIP_TO_OMEGA_RUN_FOR_SAS_RESULTS', 'I17G', 'CLOSING', 'POSTING', true, 'DIP Triggered', NULL);


INSERT INTO BUSINESS_PROCESS_STEP_EVENT_MAPPING (BUSINESS_PROCESS_STEP_ID, BUSINESS_EVENT_ID)
	VALUES(VAR_BUSINESS_PROCESS_STEP_ID_01, VAR_BUSINESS_EVENT_ID_01);

INSERT INTO BUSINESS_PROCESS_STEP_EVENT_MAPPING (BUSINESS_PROCESS_STEP_ID, BUSINESS_EVENT_ID)
	VALUES(VAR_BUSINESS_PROCESS_STEP_ID_02, VAR_BUSINESS_EVENT_ID_03);

INSERT INTO BUSINESS_PROCESS_STEP_EVENT_MAPPING (BUSINESS_PROCESS_STEP_ID, BUSINESS_EVENT_ID)
	VALUES(VAR_BUSINESS_PROCESS_STEP_ID_03, VAR_BUSINESS_EVENT_ID_05);

INSERT INTO BUSINESS_PROCESS_STEP_EVENT_MAPPING (BUSINESS_PROCESS_STEP_ID, BUSINESS_EVENT_ID)
	VALUES(VAR_BUSINESS_PROCESS_STEP_ID_04, VAR_BUSINESS_EVENT_ID_07);

INSERT INTO BUSINESS_PROCESS_STEP_EVENT_MAPPING (BUSINESS_PROCESS_STEP_ID, BUSINESS_EVENT_ID)
	VALUES(VAR_BUSINESS_PROCESS_STEP_ID_05, VAR_BUSINESS_EVENT_ID_09);

INSERT INTO BUSINESS_PROCESS_STEP_EVENT_MAPPING (BUSINESS_PROCESS_STEP_ID, BUSINESS_EVENT_ID)
	VALUES(VAR_BUSINESS_PROCESS_STEP_ID_06, VAR_BUSINESS_EVENT_ID_11);

INSERT INTO BUSINESS_PROCESS_STEP_EVENT_MAPPING (BUSINESS_PROCESS_STEP_ID, BUSINESS_EVENT_ID)
	VALUES(VAR_BUSINESS_PROCESS_STEP_ID_07, VAR_BUSINESS_EVENT_ID_13);

INSERT INTO BUSINESS_PROCESS_STEP_EVENT_MAPPING (BUSINESS_PROCESS_STEP_ID, BUSINESS_EVENT_ID)
	VALUES(VAR_BUSINESS_PROCESS_STEP_ID_08, VAR_BUSINESS_EVENT_ID_15);

EXCEPTION WHEN OTHERS THEN 
	L_ERR_CD := SUBSTR(SQLERRM, 8, 5); 
	L_ERR_MSG := SQLERRM; 
	RAISE EXCEPTION '% Error while executing SQL statement', L_ERR_MSG; 
	RETURN L_ERR_CD; 
 
END; 

END_PROC;