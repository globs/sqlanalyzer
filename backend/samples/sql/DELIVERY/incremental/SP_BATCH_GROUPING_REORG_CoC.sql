CREATE OR REPLACE PROCEDURE SP_BATCH_GROUPING_REORG_COC() RETURNS INTEGER
   LANGUAGE nzplsql AS BEGIN_PROC

DECLARE VAR_BATCH_GROUPING_ID INT;
L_ERR_CD				CHAR(5);
L_ERR_MSG				VARCHAR(32000);


BEGIN
SET ISOLATION TO UR;

DELETE FROM BATCH_GROUPING WHERE BATCH_GROUPING_NAME = 'LRM CoC PROCESSING';

SELECT BATCH_GROUPING_ID INTO VAR_BATCH_GROUPING_ID FROM BATCH_GROUPING WHERE BATCH_GROUPING_NAME = 'RDWH HISTORIZATION PROCESSING';

UPDATE EVENT_MAPPING SET BATCH_GROUPING_ID = VAR_BATCH_GROUPING_ID WHERE EVENT_CODE IN ('EVT_LRM_TO_DIP');

EXCEPTION WHEN OTHERS THEN 
	L_ERR_CD := SUBSTR(SQLERRM, 8, 5); 
	L_ERR_MSG := SQLERRM; 
	RAISE EXCEPTION '% Error while executing SQL statement', L_ERR_MSG; 
	RETURN L_ERR_CD;
 
END; 

END_PROC;