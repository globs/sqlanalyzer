CREATE OR REPLACE PROCEDURE SP_ORCHESTRATION_DATA_VALIDATION_CONTROL () RETURNS INTEGER
   LANGUAGE nzplsql AS BEGIN_PROC

DECLARE VAR_DATA_VALIDATION_CONTROL_ID INT ;
L_ERR_CD CHAR(5);
L_ERR_MSG VARCHAR(32000);

BEGIN
SET ISOLATION TO UR;

DELETE FROM DATA_VALIDATION_CONTROL;

SET VAR_DATA_VALIDATION_CONTROL_ID = NEXT VALUE FOR SEQUENCE_BATCH_METADATA;

INSERT INTO DATA_VALIDATION_CONTROL (DATA_VALIDATION_CONTROL_ID, CONTROL_NAME, CONTROL_PROCESSING, SPECIFIC_PROCESS) 
	VALUES(VAR_DATA_VALIDATION_CONTROL_ID, 'Staging Number of Rows Control', 'api-dip:stagingNumRowsControl', NULL);

SET VAR_DATA_VALIDATION_CONTROL_ID = NEXT VALUE FOR SEQUENCE_BATCH_METADATA;

INSERT INTO DATA_VALIDATION_CONTROL (DATA_VALIDATION_CONTROL_ID, CONTROL_NAME, CONTROL_PROCESSING, SPECIFIC_PROCESS) 
	VALUES(VAR_DATA_VALIDATION_CONTROL_ID, 'Verify MD5 Hash Control', 'api-dip:verifyMd5Hash', NULL);

SET VAR_DATA_VALIDATION_CONTROL_ID = NEXT VALUE FOR SEQUENCE_BATCH_METADATA;

INSERT INTO DATA_VALIDATION_CONTROL (DATA_VALIDATION_CONTROL_ID, CONTROL_NAME, CONTROL_PROCESSING, SPECIFIC_PROCESS) 
	VALUES(VAR_DATA_VALIDATION_CONTROL_ID, 'SAS AE Results Amount Control', 'api-dip:sasAEAmountTrace', NULL);

SET VAR_DATA_VALIDATION_CONTROL_ID = NEXT VALUE FOR SEQUENCE_BATCH_METADATA;

INSERT INTO DATA_VALIDATION_CONTROL (DATA_VALIDATION_CONTROL_ID, CONTROL_NAME, CONTROL_PROCESSING, SPECIFIC_PROCESS) 
	VALUES(VAR_DATA_VALIDATION_CONTROL_ID, 'Omega AE Results Amount Control', 'api-dip:omegaAEAmountTrace', NULL);


EXCEPTION WHEN OTHERS THEN 
	L_ERR_CD := SUBSTR(SQLERRM, 8, 5); 
	L_ERR_MSG := SQLERRM; 
	RAISE EXCEPTION '% Error while executing SQL statement', L_ERR_MSG; 
	RETURN L_ERR_CD; 
 
END; 

END_PROC;