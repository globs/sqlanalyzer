SET SCHEMA STAGING_<env>;

DROP TABLE WRK_UK_PROPHET_PROJECTIONS IF EXISTS;

CREATE TABLE WRK_UK_PROPHET_PROJECTIONS (
	JOIN_KEY                VARCHAR(27) NOT NULL,
	PRODUCT                 VARCHAR(22) NOT NULL,
	CONTRACT_NUMBER         VARCHAR(9) NOT NULL,
	SECTION_NUMBER          SMALLINT NOT NULL,
	ASSUMED_TREATY_NUMBER   VARCHAR(9),
	ASSUMED_SECTION_NUMBER  SMALLINT,
	RUN_NUMBER              BIGINT,
	AOC_STEP                VARCHAR(100) NOT NULL,
	SENSITIVITY_TYPE        VARCHAR(100) NOT NULL,
	SENSITIVITY_VALUE       DECIMAL(10,6) NOT NULL,
	SPCODE                  SMALLINT NOT NULL,
	POLICY_UWY              SMALLINT,
	BUSINESS_MATURITY       VARCHAR(50) NOT NULL,
	NEW_BUSINESS            SMALLINT,
	CLOSING_DATE            DATE NOT NULL,
	PERIOD                  SMALLINT NOT NULL,
	TIME                    DATE NOT NULL,
	REPORTING_BASIS         VARCHAR(100) NOT NULL,
	CURRENCY                VARCHAR(3) NOT NULL,
	EXPENSE_CURRENCY        VARCHAR(3) NOT NULL,
	PREM_INC                DECFLOAT NOT NULL,
	OPT_PREM_INC            DECFLOAT NOT NULL,
	EXT_PREM_INC            DECFLOAT NOT NULL,
	CLAIMS_INCURRED         DECFLOAT NOT NULL,
	CLAIMS_FROM_IBNP        DECFLOAT NOT NULL,
	PROFIT_COMM             DECFLOAT NOT NULL,
	IC_CLAWED_L             DECFLOAT NOT NULL,
	REN_EXP_ATTRIBUTABLE    DECFLOAT NOT NULL,
	IBNR_RES_IF             DECFLOAT NOT NULL,
	OS_LOSS_RES             DECFLOAT NOT NULL,
	SUM_ASSD_IF             DECFLOAT NOT NULL,
    INIT_COMM               DECFLOAT NOT NULL,
    REN_EXP_NONATTRIBUTABLE DECFLOAT NOT NULL,
    REN_COMM                DECFLOAT NOT NULL,
    TAX                     DECFLOAT NOT NULL,
	NO_POLS_IF              DECFLOAT NOT NULL,
	UPR_RES_IF              DECFLOAT NOT NULL,
	MATH_RES_IF             DECFLOAT NOT NULL,
	EXT_PREM_RES            DECFLOAT NOT NULL,
	CONT_RES_IF             DECFLOAT NOT NULL,
	PS_RESERVE              DECFLOAT NOT NULL,
	OPT_RES_IF              DECFLOAT NOT NULL,
	WOP_RES_IF              DECFLOAT NOT NULL,
	CIP_RES_IF              DECFLOAT NOT NULL,
	DAC_IF                  DECFLOAT NOT NULL,
	EXTPRMDAC_IF            DECFLOAT NOT NULL,
	RES_NONDEPINT           DECFLOAT NOT NULL,
	DISC_PROF_B             DECFLOAT NOT NULL,
	PROFIT                  DECFLOAT NOT NULL,
	ILS_PREM                DECFLOAT NOT NULL,
	ANUITY_OUTGO            DECFLOAT NOT NULL,
	ILS_CLAIMS              DECFLOAT NOT NULL,
	ILS_PROFIT_COMM         DECFLOAT NOT NULL,
	REN_EXP                 DECFLOAT NOT NULL,
	ILS_MAT_PROFIT_COMM     DECFLOAT NOT NULL,
    COVERAGE_UNITS          DECFLOAT NOT NULL,
	CREATED_BY              VARCHAR(20) NOT NULL,
	CREATED_DATE            TIMESTAMP NOT NULL,
	LINE_NUMBER             BIGINT,
	REQUEST_ID              BIGINT
)ORGANIZE BY COLUMN  IN TBS_<env>
    DISTRIBUTE ON RANDOM;