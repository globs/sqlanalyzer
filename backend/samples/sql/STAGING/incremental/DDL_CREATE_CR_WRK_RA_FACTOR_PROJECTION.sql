SET SCHEMA STAGING_<env>;

DROP TABLE WRK_RA_FACTOR_PROJECTION IF EXISTS;

CREATE TABLE WRK_RA_FACTOR_PROJECTION (
   REPORTING_BASIS_ID   SMALLINT,
   CLOSING_DATE         DATE         NOT NULL,
   SEGMENT_TYPE_ID      SMALLINT,
   SEGMENT_CODE         VARCHAR(16),
   SUBSIDIARY_CODE      SMALLINT,
   SUBLEDGER_CODE       SMALLINT,
   LOB_CODE             CHAR(2),
   GUARANTEE_CODE       CHAR(3),
   SOB_CODE             CHAR(2)      NOT NULL,
   TOP_CODE             CHAR(3)      NOT NULL,
   COUNTRY_OF_RISK_CODE CHAR(3),
   CEDENT_NUMBER        INTEGER,
   LEVEL_OF_ANALYSIS_ID INTEGER,
   CALCULATED_POSITION_ID INTEGER,
   TERM_TYPE_ID         SMALLINT,
   COVER_TYPE_ID        SMALLINT,
   BUSINESS_MATURITY_ID SMALLINT,
   BASIS_TYPE_ID        SMALLINT,
   ACTUARIAL_MODEL_TYPE_ID SMALLINT,
   IS_PRESENT_VALUE     BOOLEAN,
   LIFE_TREATY_TYPE_CODE VARCHAR(5),
   FINANCING_TYPE_CODE  VARCHAR(5),
   IAS39_CODE           SMALLINT,
   USGAAP_CODE          SMALLINT,
   TYPE_OF_BUSINESS_CODE SMALLINT,
   BUSINESS_MATURITY_FLAG VARCHAR(4),
   IFRS17_PORTFOLIO     VARCHAR(40),
   IFRS17_SUB_PORTFOLIO VARCHAR(40),
   TRANSITION_MODE      VARCHAR(20),
   INITIAL_PROFITABILITY VARCHAR(20),
   PROJECTION_YEAR      SMALLINT            NOT NULL,
   PROJECTION_PERIOD    SMALLINT            NOT NULL,
   PERIOD_TYPE_ID       SMALLINT            NOT NULL,
   FACTOR               DECFLOAT,   
   REQUEST_ID           BIGINT           NOT NULL
)
    ORGANIZE BY COLUMN IN TBS_<env> DISTRIBUTE ON RANDOM;


