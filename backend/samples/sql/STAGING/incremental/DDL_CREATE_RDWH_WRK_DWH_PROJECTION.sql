SET SCHEMA STAGING_<env>;

DROP TABLE WRK_DWH_PROJECTION IF EXISTS;

CREATE TABLE WRK_DWH_PROJECTION
(
    CONTRACT_NUMBER         CHARACTER(9)  NOT NULL,
    SECTION_NUMBER          SMALLINT      NOT NULL,
    ASSUMED_CONTRACT_NUMBER CHARACTER(9),
    ASSUMED_SECTION_NUMBER  SMALLINT,
    UNDERWRITING_ORDER      SMALLINT,
    ENDORSEMENT_NUMBER      SMALLINT,
    SPLIT                   VARCHAR(100),
    SPLIT_TYPE_ID           SMALLINT,
    AOC_STEP                VARCHAR(100)  NOT NULL,
    LEVEL_OF_ANALYSIS_ID    INTEGER       NOT NULL,
    SENSITIVITY_TYPE        VARCHAR(100)  NOT NULL,
    SCENARIO_TYPE_ID        INTEGER       NOT NULL,
    SENSITIVITY_VALUE       DECIMAL(10,6) NOT NULL,
    SCENARIO_PARAMETER      DECIMAL(10,6) NOT NULL,
    POLICY_UW_YEAR          SMALLINT,
    UNDERWRITING_YEAR       SMALLINT,
    BUSINESS_MATURITY       VARCHAR(50)   NOT NULL,
    NEW_BUSINESS_IND        VARCHAR(5),
    BUSINESS_MATURITY_ID    SMALLINT      NOT NULL,
    POSITION                VARCHAR(100)  NOT NULL,
    POSITION_ID             INTEGER       NOT NULL,
    CURRENCY_CODE           CHARACTER(3)  NOT NULL,
    BASIS                   VARCHAR(100)  NOT NULL,
    REPORTING_BASIS_ID      SMALLINT      NOT NULL,
    CLOSING_DATE            DATE          NOT NULL,
    PERM_TERM_TYPE          VARCHAR(16),
    HISTORIZATION_MODE      VARCHAR(20)   NOT NULL,
    P_TIME                  DATE,
    PROJECTION_MONTH        SMALLINT      NOT NULL,
    PROJECTION_YEAR         SMALLINT      NOT NULL,
    PROJECTION_DATE         DATE          NOT NULL,
    PERIOD_TYPE_ID          SMALLINT      NOT NULL,
    PERIOD_DESCRIPTION      VARCHAR(10),
    AMOUNT                  DECFLOAT(34)  NOT NULL,
    CREATED_BY              VARCHAR(64)   NOT NULL,
    CREATED_DATE            TIMESTAMP(6)  NOT NULL,
    LINE_NUMBER             BIGINT,
    REQUEST_ID              BIGINT,
    SOURCE_REF_NAME         VARCHAR(255)
)
    IN TBS_<env>
    DISTRIBUTE BY RANDOM;