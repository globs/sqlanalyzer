SET SCHEMA STAGING_<env>;

DROP TABLE WRK_APAC_PROPHET_PROJECTIONS IF EXISTS;

CREATE TABLE WRK_APAC_PROPHET_PROJECTIONS
(
    JOIN_KEY                  VARCHAR(27),
    PRODUCT                   VARCHAR(22)   NOT NULL,
    CONTRACT_NUMBER           CHARACTER(9)  NOT NULL,
    SECTION_NUMBER            SMALLINT      NOT NULL,
    ASSUMED_CONTRACT_NUMBER   CHARACTER(9),
    ASSUMED_SECTION_NUMBER    SMALLINT,
    RUN_NUMBER                INTEGER,
    AOC_STEP                  VARCHAR(100)  NOT NULL,
    SENSITIVITY_TYPE          VARCHAR(100)  NOT NULL,
    SENSITIVITY_VALUE         DECIMAL(10,6) NOT NULL,
    SPCODE                    SMALLINT,
    POLICY_UWY                SMALLINT,
    BUSINESS_MATURITY         VARCHAR(50)   NOT NULL,
    NEW_BUSINESS              SMALLINT,
    CLOSING_DATE              DATE          NOT NULL,
    P_PERIOD                  SMALLINT,
    P_TIME                    DATE          NOT NULL,
    REPORTING_BASIS           VARCHAR(50)   NOT NULL,
    CURRENCY                  VARCHAR(3)    NOT NULL,
    PREM_WRITTEN              DECFLOAT(16)  NOT NULL,
    CLAIMS_INCURRED           DECFLOAT(16)  NOT NULL,
    CLAIMS_FROM_IBNP          DECFLOAT(16)  NOT NULL,
    COLLATERAL_COST           DECFLOAT(16)  NOT NULL,
    TOT_COMM                  DECFLOAT(16)  NOT NULL,
    FIN_COMM                  DECFLOAT(16)  NOT NULL,
    FIN_BROK_FEE              DECFLOAT(16)  NOT NULL,
    RETRO_OVERRIDE_COMM       DECFLOAT(16)  NOT NULL,
    PS_TOTAL_ALLOCATION       DECFLOAT(16)  NOT NULL,
    DEP_MATH_RES_IF           DECFLOAT(16)  NOT NULL,
    DEP_UNEARN_PREM_RES_IF    DECFLOAT(16)  NOT NULL,
    DEP_INC_RISK_RES_IF       DECFLOAT(16)  NOT NULL,
    NDEP_MATH_RES_IF          DECFLOAT(16)  NOT NULL,
    NDEP_UNEARN_PREM_RES_IF   DECFLOAT(16)  NOT NULL,
    NDEP_INC_RISK_RES_IF      DECFLOAT(16)  NOT NULL,
    DEP_IBNP_RES_IF           DECFLOAT(16)  NOT NULL,
    NDEP_IBNP_RES_IF          DECFLOAT(16)  NOT NULL,
    DAC_IF                    DECFLOAT(16)  NOT NULL,
    RES_DEPINT                DECFLOAT(16)  NOT NULL,
    RES_NONDEPINT             DECFLOAT(16)  NOT NULL,
    TOT_REN_EXP               DECFLOAT(16)  NOT NULL,
    TOT_ACQ_EXP               DECFLOAT(16)  NOT NULL,
    TOT_INV_EXP               DECFLOAT(16)  NOT NULL,
    TAX                       DECFLOAT(16)  NOT NULL,
    SUM_ASSD_IF               DECFLOAT(16)  NOT NULL,
    VOBA                      DECFLOAT(16)  NOT NULL,
    PV_PS_TOTAL_ALLOCATION    DECFLOAT(16)  NOT NULL,
    PREM_TAX                  DECFLOAT(16)  NOT NULL,
    PREM_REFUND               DECFLOAT(16)  NOT NULL,
    INIT_COMM                 DECFLOAT(16)  NOT NULL,
    COMM_CLAWBACK             DECFLOAT(16)  NOT NULL,
    REN_COMM                  DECFLOAT(16)  NOT NULL,
    REN_EXP_ATTRIBUTABLE      DECFLOAT(16)  NOT NULL,
    ACQ_EXP_ATTRIBUTABLE      DECFLOAT(16)  NOT NULL,
    INV_EXP_ATTRIBUTABLE      DECFLOAT(16)  NOT NULL,
    CLAIM_EXP_ATTRIBUTABLE    DECFLOAT(16)  NOT NULL,
    REN_EXP_NONATTRIBUTABLE   DECFLOAT(16)  NOT NULL,
    ACQ_EXP_NONATTRIBUTABLE   DECFLOAT(16)  NOT NULL,
    INV_EXP_NONATTRIBUTABLE   DECFLOAT(16)  NOT NULL,
    CLAIM_EXP_NONATTRIBUTABLE DECFLOAT(16)  NOT NULL,
    COVERAGE_UNITS            DECFLOAT(16)  NOT NULL,
    CREATED_BY                VARCHAR(20)   NOT NULL,
    CREATED_DATE              TIMESTAMP(6)  NOT NULL,
    LINE_NUMBER               BIGINT,
    REQUEST_ID                BIGINT
)
    ORGANIZE BY COLUMN IN TBS_<env> DISTRIBUTE ON RANDOM;