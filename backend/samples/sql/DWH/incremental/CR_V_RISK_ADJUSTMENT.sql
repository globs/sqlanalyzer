SET SQL_COMPAT='NPS';

DROP VIEW V_RISK_ADJUSTMENT;

CREATE OR REPLACE VIEW V_RISK_ADJUSTMENT (
	VALIDFROM,
	VALIDTO,
	SEGMENTTYPE,
	SEGMENTCODE,
	CONTRACTNATURECODE,
	SUBSIDIARYCODE,
	SUBLEDGERCODE,
	RISKADJUSTMENTTYPECODE,
	RISKADJUSTMENTFACTOR,
	RISK_ADJUSTMENT_TYPE_ID,
	SEGMENT_TYPE_ID,
	NORM_CODE,
	PARAMETER_TYPE_ID,
	DOMAIN_CODE,
	CLOSING_DATE
) AS
SELECT 
	ADJUSTEMENT_FACTOR.VALID_FROM AS VALIDFROM,
	ADJUSTEMENT_FACTOR.VALID_TO AS VALIDTO,
	SEGMENT_TYPE.CODE AS SEGMENTTYPE,
	ADJUSTEMENT_FACTOR.SEGMENT_CODE AS SEGMENTCODE,
	ADJUSTEMENT_FACTOR.CONTRACT_NATURE_CODE AS CONTRACTNATURECODE, 
	ADJUSTEMENT_FACTOR.SUBSIDIARY_CODE AS SUBSIDIARYCODE,
	ADJUSTEMENT_FACTOR.SUBLEDGER_CODE AS SUBLEDGERCODE, 
	ADJUSTMENT_FACTOR_TYPE.CODE AS RISKADJUSTMENTTYPECODE, 
	ADJUSTEMENT_FACTOR.FACTOR AS RISKADJUSTMENTFACTOR,
	ADJUSTMENT_FACTOR_TYPE.ID AS RISK_ADJUSTMENT_TYPE_ID,
	ADJUSTEMENT_FACTOR.SEGMENT_TYPE_ID,
	REPORTING_BASIS.CODE AS NORM_CODE,
	ADJUSTEMENT_FACTOR.PARAMETER_TYPE_ID,
	ADJUSTEMENT_FACTOR.DOMAIN_CODE,
	ADJUSTEMENT_FACTOR.CLOSING_DATE
FROM
	DWH_ADJUSTMENT_FACTOR ADJUSTEMENT_FACTOR
	INNER JOIN
		DWH_PARAMETER_TYPE PARAMETER_TYPE
		ON ADJUSTEMENT_FACTOR.PARAMETER_TYPE_ID = PARAMETER_TYPE.ID 
	INNER JOIN
		DWH_REPORTING_BASIS REPORTING_BASIS
		ON REPORTING_BASIS.ID = ADJUSTEMENT_FACTOR.REPORTING_BASIS_ID 
	INNER JOIN
		DWH_ADJUSTMENT_FACTOR_TYPE ADJUSTMENT_FACTOR_TYPE
		ON ADJUSTEMENT_FACTOR.FACTOR_TYPE_ID = ADJUSTMENT_FACTOR_TYPE.ID 
	INNER JOIN
		DWH_SEGMENT_TYPE SEGMENT_TYPE
		ON ADJUSTEMENT_FACTOR.SEGMENT_TYPE_ID = SEGMENT_TYPE.ID;