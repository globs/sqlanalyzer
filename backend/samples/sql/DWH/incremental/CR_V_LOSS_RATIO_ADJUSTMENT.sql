SET SQL_COMPAT='NPS';

DROP VIEW V_LOSS_RATIO_ADJUSTMENT;

CREATE OR REPLACE VIEW V_LOSS_RATIO_ADJUSTMENT (VALIDFROM, VALIDTO, SEGMENTCODE, SEGMENTTYPE, CONTRACTNATURECODE, SUBSIDIARYCODE, SUBLEDGERCODE, PARAMETER_TYPE_ID, SEGMENT_TYPE_ID 
) AS
(
SELECT 
    ADJUSTEMENT_FACTOR.VALID_FROM            AS VALIDFROM,
    ADJUSTEMENT_FACTOR.VALID_TO              AS VALIDTO,
    ADJUSTEMENT_FACTOR.SEGMENT_CODE          AS SEGMENTCODE, 
    SEGMENT_TYPE.CODE               		 AS SEGMENTTYPE, 
    ADJUSTEMENT_FACTOR.CONTRACT_NATURE_CODE  AS CONTRACTNATURECODE, 
    ADJUSTEMENT_FACTOR.SUBSIDIARY_CODE       AS SUBSIDIARYCODE, 
    ADJUSTEMENT_FACTOR.SUBLEDGER_CODE        AS SUBLEDGERCODE, 
    ADJUSTEMENT_FACTOR.PARAMETER_TYPE_ID, 
    ADJUSTEMENT_FACTOR.SEGMENT_TYPE_ID
FROM DWH_ADJUSTMENT_FACTOR ADJUSTEMENT_FACTOR
INNER JOIN DWH_SEGMENT_TYPE SEGMENT_TYPE ON ADJUSTEMENT_FACTOR.SEGMENT_TYPE_ID = SEGMENT_TYPE.CODE 
);