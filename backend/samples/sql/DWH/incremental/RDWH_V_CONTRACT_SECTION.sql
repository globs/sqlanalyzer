DROP VIEW V_CONTRACT_SECTION;

CREATE OR REPLACE VIEW V_CONTRACT_SECTION (
   ASSUMED_OR_RETRO
	,CONTRACT_NUMBER
	,UNDERWRITING_YEAR
	,SECTION_NUMBER
	,UNDERWRITING_ORDER
	,ENDORSEMENT_NUMBER
	,SUBSIDIARY_CODE
	,CEDENT_NUMBER
	,ACCOUNT_GRP_CODE
	,LOB_CODE
	,GUARANTEE_CODE
	,NATURE_CODE
	,PRODUCT_LABEL
	,REGION_CODE
	,LEGAL_ENTITY_CODE
	,ORIG_CEDENT_NUMBER
	,ANALYSIS_COUNTRY_CODE
	,IS_PROPORTIONAL
	,TYPE_REINS_CODE
	,CONTRACT_TYPE_CODE
	,CONTRACT_TYPE2_CODE
	,CONTRACT_TYPE3_CODE
	,PRINCIPAL_RISK_CODE
)AS 
(
	SELECT
		'A' 				AS ASSUMED_OR_RETRO	
		,UWSEC.CTR_NF 		AS CONTRACT_NUMBER
		,UWSEC.UWY_NF 		AS UNDERWRITING_YEAR
		,UWSEC.SEC_NF 		AS SECTION_NUMBER
		,UWSEC.UW_NT 		AS UNDERWRITING_ORDER
		,UWSEC.END_NT 		AS ENDORSEMENT_NUMBER
		,UWSEC.SSD_CF 		AS SUBSIDIARY_CODE
		,UWSEC.CED_NF 		AS CEDENT_NUMBER
		,UWSEC.ACCGRP_CF 	AS ACCOUNT_GRP_CODE
		,UWSEC.LOB_CF 		AS LOB_CODE
		,UWSEC.GAR_CF 		AS GUARANTEE_CODE
		,UWSEC.NAT_CF 		AS NATURE_CODE
		,UWSEC.PRDCOD_LS	AS PRODUCT_LABEL
		,UWSEC.REG_NF 		AS REGION_CODE
		,UWSEC.ENTLEG_NT	AS LEGAL_ENTITY_CODE
		,UWSEC.ORGCED_NF	AS ORIG_CEDENT_NUMBER
		,UWSEC.ANLCTY_CF	AS ANALYSIS_COUNTRY_CODE
		,UWSEC.NAT_B 		AS IS_PROPORTIONAL
		,UWSEC.TYPREI_CF 	AS TYPE_REINS_CODE
		,UWSEC.CTRTYP_CT 	AS CONTRACT_TYPE_CODE
		,UWSEC.CTRTYP2_CT	AS CONTRACT_TYPE2_CODE
		,UWSEC.CTRTYP3_CT	AS CONTRACT_TYPE3_CODE
		,UWSEC.PCPRSK_NF	AS PRINCIPAL_RISK_CODE
		FROM BI_<env>.TUWSEC AS UWSEC
		WHERE DATE(UWSEC.END_D) = '9999-12-31'
			AND DATE(UWSEC.SUPP_D) = '9999-12-31'
		UNION
	SELECT
		'R' 						AS ASSUMED_OR_RETRO
		,UWRETSEC.RETCTR_NF 		AS CONTRACT_NUMBER
		,UWRETSEC.RTY_NF 			AS UNDERWRITING_YEAR
		,UWRETSEC.RETSEC_NF 		AS SECTION_NUMBER
		,NULL 						AS UNDERWRITING_ORDER
		,NULL 						AS ENDORSEMENT_NUMBER
		,UWRETSEC.SSD_CF 			AS SUBSIDIARY_CODE
		,NULL 						AS CEDENT_NUMBER
		,NULL 						AS ACCOUNT_GRP_CODE
		,UWRETSEC.LOB_CF 			AS LOB_CODE
		,UWRETSEC.GAR_CF			AS GUARANTEE_CODE
		,UWRETSEC.NAT_CF			AS NATURE_CODE
		,NULL 						AS PRODUCT_LABEL
		,NULL 						AS REGION_CODE
		,UWRETSEC.RETLEGENTITY_CF	AS LEGAL_ENTITY_CODE
		,NULL 						AS ORIG_CEDENT_NUMBER
		,UWRETSEC.RPOTRY_CF 		AS ANALYSIS_COUNTRY_CODE
		,NULL 						AS IS_PROPORTIONAL
		,NULL 						AS TYPE_REINS_CODE
		,NULL 						AS CONTRACT_TYPE_CODE
		,NULL 						AS CONTRACT_TYPE2_CODE
		,NULL 						AS CONTRACT_TYPE3_CODE
		,NULL 						AS PRINCIPAL_RISK_CODE
FROM
   BI_<env>.TUWRETSEC AS UWRETSEC
WHERE DATE(UWRETSEC.END_D) = '9999-12-31'
AND DATE(UWRETSEC.SUPP_D) = '9999-12-31'
);
