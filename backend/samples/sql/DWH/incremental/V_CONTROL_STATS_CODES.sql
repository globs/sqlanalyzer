CREATE OR REPLACE
VIEW V_CONTROL_STATS_CODES (SSD_CF,
ESB_CF,
STAT_NAME,
STAT_VALUE,
BALSHRMTH_NF,
BALSHEY_NF) AS (
SELECT SSD_CF,
	ESB_CF,
	'CODES_ROWS' AS STAT_NAME,
	COUNT(1) AS STAT_VALUE,
	BALSHRMTH_NF,
	BALSHEY_NF
FROM BI_<env>.TFULLGLT
GROUP BY SSD_CF, ESB_CF,
	BALSHRMTH_NF,
	BALSHEY_NF
UNION
SELECT SSD_CF,
	ESB_CF,
	'CODES_TC_ROWS' AS STAT_NAME,
	COUNT(1) AS STAT_VALUE,
	BALSHRMTH_NF,
	BALSHEY_NF
FROM BI_<env>.TFULLGLT
WHERE  TRNCOD_CF IS NULL
GROUP BY SSD_CF, ESB_CF,
	BALSHRMTH_NF,
	BALSHEY_NF
UNION
SELECT SSD_CF,
	ESB_CF,
	'CODES_DBLTC_ROWS' AS STAT_NAME,
	COUNT(1) AS STAT_VALUE,
	BALSHRMTH_NF,
	BALSHEY_NF
FROM BI_<env>.TFULLGLT
WHERE  DBLTRNCOD_CF IS NULL
GROUP BY SSD_CF, ESB_CF,
	BALSHRMTH_NF,
	BALSHEY_NF
UNION
SELECT SSD_CF,
	ESB_CF,
	'CODES_GAAPCOD_ROWS' AS STAT_NAME,
	COUNT(1) AS STAT_VALUE,
	BALSHRMTH_NF,
	BALSHEY_NF
FROM BI_<env>.TFULLGLT
WHERE  GAAPCOD_NT IS NULL
GROUP BY SSD_CF, ESB_CF,
	BALSHRMTH_NF,
	BALSHEY_NF);